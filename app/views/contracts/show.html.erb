<% content_for :title, "Contract - #{@contract.name}" %>
<% content_for :actions,
  link_to('Reports', reports_contract_path(@contract), class: 'btn btn-sm btn-outline-primary').concat(
  link_to('Edit', edit_project_path(@contract.project), class: 'btn btn-sm btn-outline-primary').concat(
    link_to('Back', contracts_path, class: 'btn btn-sm btn-outline-secondary')))
%>

<p id="notice"><%= notice %></p>
<p>
  <strong>Project:</strong> <%= link_to @contract.project.name, @contract.project  %>
</p>
<% unless @contract.alias.empty? %>
  <p>
    <strong>Alias:</strong> <%= @contract.alias_list %>
  </p>
<% end %>
<p>
  <strong>Budget:</strong> <%= number_to_currency(@contract.budget, unit: '€') %>
</p>

<br>
<h4>Project Burn</h4>
<%= line_chart @data, prefix: '€', thousands: "," %>

<br>

<h2>Reports</h2>
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Period</th>
      <th>User</th>
      <th>Team</th>
      <th>Role</th>
      <th>Percentage</th>
      <th>Days</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <% @contract.full_reports.joins(:reporting_period).
       order("reporting_periods.date DESC").each do |report| %>
      <tr>
        <td><%= report.reporting_period_name %></td>
        <td><%= report.user_name %></td>
        <td><%= report.team_name %></td>
        <td><%= report.role_name %></td>
        <td><%= report.percentage %>%</td>
        <td><%= report.days %></td>
        <td><%= number_to_currency(report.cost, unit: '€')  %></td>
      </tr>
    <% end %>
  </tbody>
</table>
