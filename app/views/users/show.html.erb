<% content_for :title, "#{@user.name}" %>
<% content_for :actions,
  link_to('Edit', edit_user_path(@user), class: 'btn btn-sm btn-outline-primary').concat(
    link_to('Back', users_path, class: 'btn btn-sm btn-outline-secondary')) %>

<p id="notice"><%= notice %></p>
<p>
  <strong>Name:</strong>
  <%= @user.name %>
</p>

<p>
  <strong>Team:</strong>
  <%= @user.team.try(:name) %>
</p>

<p>
  <strong>Roles:</strong>
  <%= @user.role.try(:name) %>
</p>

<%= form_with(url: @project, method: :get, local: true) do |form| %>
  <div class="form-group">
    <%= form.label :reporting_period_id %>
    <%= form.select :reporting_period_id, options_from_collection_for_select(@reporting_periods, :id, :display_name, selected: params[:reporting_period_id]), { prompt: true }, class: "form-control" %>
  </div>
  <div class="actions">
    <%= form.submit "Filter" %>
  </div>
<% end %>

<br>

<h4>% of Time in a project</h4>
<%= column_chart @data, stacked: true %>

<br>


<h2>Reports</h2>
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Period</th>
      <th>Contract</th>
      <th>Percentage</th>
      <th>Days</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <% @user.full_reports.joins(:reporting_period).
        order("reporting_periods.date ASC").each do |report| %>
      <tr>
        <td><%= report.reporting_period_name %></td>
        <td><%= report.contract_name %></td>
        <td><%= report.percentage %>%</td>
        <td><%= report.days %></td>
        <td><%= number_to_currency(report.cost, unit: 'â‚¬')  %></td>
      </tr>
    <% end %>
  </tbody>
</table>
